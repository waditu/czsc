# CZSC é¡¹ç›®æ ¸å¿ƒå·¥å…·

## æ–‡æ¡£æ¦‚è¿°

æœ¬æ–‡æ¡£æ—¨åœ¨å¸®åŠ©æ–°ç”¨æˆ·å¿«é€Ÿäº†è§£ CZSCï¼ˆç¼ ä¸­è¯´ç¦…æŠ€æœ¯åˆ†æå·¥å…·ï¼‰åº“ä¸­å¯ç”¨çš„å®ç”¨å·¥å…·ï¼ŒæŒ‰æ¨¡å—åˆ†ç±»åˆ—å‡ºæ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½ï¼Œå¹¶æä¾›ä½¿ç”¨åœºæ™¯å’ŒAPIå‚è€ƒã€‚

### å¦‚ä½•ä½¿ç”¨æœ¬æ–‡æ¡£

- **ç³»ç»Ÿå­¦ä¹ **ï¼šæŒ‰æ¨¡å—é¡ºåºé˜…è¯»ï¼Œäº†è§£CZSCçš„å®Œæ•´å·¥å…·ä½“ç³»
- **æŒ‰éœ€æŸ¥é˜…**ï¼šé€šè¿‡"æŒ‰åŠŸèƒ½æŸ¥æ‰¾ç´¢å¼•"å¿«é€Ÿå®šä½æ‰€éœ€å·¥å…·
- **å¿«é€Ÿä¸Šæ‰‹**ï¼šå‚è€ƒ"å¿«é€Ÿä¸Šæ‰‹æŒ‡å—"å¼€å§‹ç¬¬ä¸€ä¸ªé¡¹ç›®

### å·¥å…·é‡è¦æ€§æ ‡æ³¨

- **â­ å¿…ç”¨é«˜é¢‘** - å‡ ä¹æ¯ä¸ªCZSCé¡¹ç›®éƒ½ä¼šç”¨åˆ°ï¼Œå»ºè®®ä¼˜å…ˆæŒæ¡
- **ğŸ”¥ å¸¸ç”¨ä¸­é¢‘** - å¤§å¤šæ•°ç­–ç•¥ç ”ç©¶éœ€è¦ï¼Œé‡è¦ç¨‹åº¦æ¬¡ä¹‹
- **ğŸ’¡ ç‰¹å®šåœºæ™¯** - ç‰¹å®šéœ€æ±‚æ—¶ä½¿ç”¨ï¼ŒæŒ‰éœ€å­¦ä¹ 

---

## 1. æ ¸å¿ƒåˆ†æå·¥å…· (czsc/core.py)

### æ¨¡å—æ¦‚è¿°

æ ¸å¿ƒåˆ†æå·¥å…·æ˜¯ CZSC åº“çš„åŸºç¡€ï¼Œå®ç°äº†ç¼ è®ºçš„åˆ†å‹ã€ç¬”ã€çº¿æ®µç­‰æ ¸å¿ƒæ¦‚å¿µçš„è‡ªåŠ¨è¯†åˆ«ï¼Œä»¥åŠåŸºäºæ­¤çš„å¤šçº§åˆ«é‡åŒ–äº¤æ˜“ç­–ç•¥ã€‚

### å·¥å…·åˆ—è¡¨

| å·¥å…·åç§° | é‡è¦æ€§ | åŠŸèƒ½è¯´æ˜ | ä½¿ç”¨åœºæ™¯ |
|---------|--------|----------|----------|
| `CZSC` | â­ | ç¼ è®ºåˆ†ææ ¸å¿ƒç±»ï¼Œå®ç°åˆ†å‹ã€ç¬”ã€çº¿æ®µè¯†åˆ« | æ‰€æœ‰ç¼ è®ºåˆ†æçš„åŸºç¡€ |
| `RawBar` | â­ | åŸå§‹Kçº¿æ•°æ®ç»“æ„ | Kçº¿æ•°æ®å¤„ç† |
| `NewBar` | â­ | åˆæˆKçº¿æ•°æ®ç»“æ„ | å¤šçº§åˆ«Kçº¿åˆæˆ |
| `Freq` | â­ | Kçº¿é¢‘ç‡æšä¸¾ï¼ˆæ—¥çº¿ã€30åˆ†é’Ÿç­‰ï¼‰ | æŒ‡å®šKçº¿å‘¨æœŸ |
| `format_standard_kline` | â­ | DataFrameè½¬RawBaråˆ—è¡¨ | æ•°æ®æ ¼å¼è½¬æ¢ |
| `BarGenerator` | â­ | Kçº¿ç”Ÿæˆå™¨ï¼Œæ”¯æŒå¤šçº§åˆ«åˆæˆ | å¤šçº§åˆ«åˆ†æ |
| `Signal` | ğŸ”¥ | ä¿¡å·æ•°æ®ç»“æ„ | ä¿¡å·ç”Ÿæˆä¸ä¼ é€’ |
| `Event` | ğŸ”¥ | äº‹ä»¶æ•°æ®ç»“æ„ | äº‹ä»¶å®šä¹‰ä¸åŒ¹é… |
| `Position` | ğŸ”¥ | æŒä»“æ•°æ®ç»“æ„ | æŒä»“ç®¡ç† |
| `Operate` | ğŸ”¥ | æ“ä½œæšä¸¾ï¼ˆå¼€å¤šã€å¹³å¤šç­‰ï¼‰ | äº¤æ˜“æ“ä½œå®šä¹‰ |
| `Direction` | ğŸ”¥ | æ–¹å‘æšä¸¾ï¼ˆå‘ä¸Šã€å‘ä¸‹ï¼‰ | è¶‹åŠ¿æ–¹å‘åˆ¤æ–­ |
| `ZS` | ğŸ’¡ | ä¸­æ¢æ•°æ®ç»“æ„ | ä¸­æ¢åˆ†æ |

### API å‚è€ƒ

```python
# CZSC åˆ†æå™¨
czsc_obj = CZSC(bars, max_bi_num=envs.get_max_bi_num())

# æ•°æ®æ ¼å¼è½¬æ¢
bars = format_standard_kline(df, freq=Freq.F30)

# Kçº¿ç”Ÿæˆå™¨
bg = BarGenerator(base_freq=Freq.F30, freqs=[Freq.F30, Freq.FD, FreqFW])
bg.update(bars)
```

### å¿«é€Ÿç¤ºä¾‹

```python
from czsc.core import CZSC, format_standard_kline, Freq
from czsc.mock import generate_symbol_kines

# ç”Ÿæˆæµ‹è¯•æ•°æ®
df = generate_symbol_kines('000001', '30åˆ†é’Ÿ', '20240101', '20240105')

# è½¬æ¢ä¸ºCZSCå¯¹è±¡
bars = format_standard_kline(df, freq=Freq.F30)
czsc_obj = CZSC(bars)

# è®¿é—®åˆ†æç»“æœ
print(f"ç¬”çš„æ•°é‡: {len(czsc_obj.bi_list)}")
```

---

## 2. æ•°æ®è·å–ä¸å¤„ç† (czsc/utils/data_client.py)

### æ¨¡å—æ¦‚è¿°

ç»Ÿä¸€æ•°æ®å®¢æˆ·ç«¯æ¥å£ï¼Œæ”¯æŒå¤©å‹¤ã€Tushareã€èšå®½ã€CCXTç­‰å¤šä¸ªæ•°æ®æºï¼Œæä¾›ä¸€è‡´çš„æ•°æ®è®¿é—®æ–¹å¼ã€‚

### å·¥å…·åˆ—è¡¨

| å·¥å…·åç§° | é‡è¦æ€§ | åŠŸèƒ½è¯´æ˜ | ä½¿ç”¨åœºæ™¯ |
|---------|--------|----------|----------|
| `DataClient` | â­ | ç»Ÿä¸€æ•°æ®å®¢æˆ·ç«¯æ¥å£ | è·å–å¤šæºå¸‚åœºæ•°æ® |
| `set_url_token` | â­ | è®¾ç½®æ•°æ®æºToken | æ•°æ®æºè®¤è¯ |
| `get_url_token` | ğŸ”¥ | è·å–å­˜å‚¨çš„Token | Tokenç®¡ç† |
| `generate_fernet_key` | ğŸ’¡ | ç”ŸæˆåŠ å¯†å¯†é’¥ | æ•æ„Ÿæ•°æ®åŠ å¯† |
| `fernet_encrypt` | ğŸ’¡ | æ•°æ®åŠ å¯† | å®‰å…¨å­˜å‚¨ |
| `fernet_decrypt` | ğŸ’¡ | æ•°æ®è§£å¯† | è¯»å–åŠ å¯†æ•°æ® |

### API å‚è€ƒ

```python
# åˆ›å»ºæ•°æ®å®¢æˆ·ç«¯
dc = DataClient(symbol="000001", sdt="20240101", edt="20240131", freq="30åˆ†é’Ÿ")

# è·å–Kçº¿æ•°æ®
df = dc.get_kline()

# Tokenç®¡ç†
set_url_token("tushare", "your_token_here")
token = get_url_token("tushare")
```

### å¿«é€Ÿç¤ºä¾‹

```python
from czsc.utils import DataClient

# åˆ›å»ºå®¢æˆ·ç«¯å¹¶è·å–æ•°æ®
dc = DataClient(symbol="000001", sdt="20240101", edt="20240105")
df = dc.get_kline()

print(df.head())
```

---

## 3. æŠ€æœ¯åˆ†ææŒ‡æ ‡ (czsc/utils/ta.py)

### æ¨¡å—æ¦‚è¿°

æä¾›å„ç±»å¸¸ç”¨æŠ€æœ¯åˆ†ææŒ‡æ ‡çš„è®¡ç®—å‡½æ•°ï¼ŒåŒ…æ‹¬è¶‹åŠ¿æŒ‡æ ‡ã€æŒ¯è¡æŒ‡æ ‡ã€æˆäº¤é‡æŒ‡æ ‡ç­‰ã€‚

### å·¥å…·åˆ—è¡¨

| å·¥å…·åç§° | é‡è¦æ€§ | åŠŸèƒ½è¯´æ˜ | ä½¿ç”¨åœºæ™¯ |
|---------|--------|----------|----------|
| `MACD` | â­ | MACDæŒ‡æ ‡è®¡ç®— | è¶‹åŠ¿åˆ¤æ–­ |
| `RSI` | â­ | RSIæŒ‡æ ‡è®¡ç®— | è¶…ä¹°è¶…å–åˆ¤æ–­ |
| `BOLL` | â­ | å¸ƒæ—å¸¦è®¡ç®— | æ³¢åŠ¨ç‡åˆ†æ |
| `KDJ` | ğŸ”¥ | KDJæŒ‡æ ‡è®¡ç®— | çŸ­æœŸäº¤æ˜“ä¿¡å· |
| `ATR` | ğŸ”¥ | ATRçœŸå®æ³¢å¹… | é£é™©ç®¡ç† |
| `SMA` | ğŸ”¥ | ç®€å•ç§»åŠ¨å¹³å‡çº¿ | è¶‹åŠ¿è·Ÿè¸ª |
| `EMA` | ğŸ”¥ | æŒ‡æ•°ç§»åŠ¨å¹³å‡çº¿ | è¶‹åŠ¿è·Ÿè¸ª |
| `WMA` | ğŸ’¡ | åŠ æƒç§»åŠ¨å¹³å‡çº¿ | è‡ªå®šä¹‰æƒé‡ |
| `VOLUME_MA` | ğŸ’¡ | æˆäº¤é‡å‡çº¿ | æˆäº¤é‡åˆ†æ |

### API å‚è€ƒ

```python
# MACDæŒ‡æ ‡
macd_result = MACD(df['close'], fast=12, slow=26, signal=9)

# RSIæŒ‡æ ‡
rsi_value = RSI(df['close'], period=14)

# å¸ƒæ—å¸¦
upper, middle, lower = BOLL(df['close'], period=20, std_dev=2)
```

### å¿«é€Ÿç¤ºä¾‹

```python
from czsc.utils import ta

# è®¡ç®—MACD
macd_df = ta.MACD(df['close'])
print(macd_df[['dif', 'dea', 'bar']].tail())

# è®¡ç®—RSI
rsi = ta.RSI(df['close'], period=14)
print(f"æœ€æ–°RSIå€¼: {rsi.iloc[-1]:.2f}")
```

---

## 4. ç¼“å­˜ä¸æ€§èƒ½ (czsc/utils/cache.py)

### æ¨¡å—æ¦‚è¿°

æä¾›é«˜æ•ˆçš„ç£ç›˜ç¼“å­˜æœºåˆ¶ï¼Œé¿å…é‡å¤è®¡ç®—ï¼Œæ˜¾è‘—æå‡æ€§èƒ½ã€‚æ”¯æŒå‡½æ•°çº§è£…é¥°å™¨å’Œç±»çº§ç¼“å­˜ç®¡ç†ã€‚

### å·¥å…·åˆ—è¡¨

| å·¥å…·åç§° | é‡è¦æ€§ | åŠŸèƒ½è¯´æ˜ | ä½¿ç”¨åœºæ™¯ |
|---------|--------|----------|----------|
| `disk_cache` | â­ | ç£ç›˜ç¼“å­˜è£…é¥°å™¨ | å‡½æ•°ç»“æœç¼“å­˜ |
| `DiskCache` | â­ | ç¼“å­˜ç®¡ç†ç±» | é«˜çº§ç¼“å­˜æ§åˆ¶ |
| `home_path` | ğŸ”¥ | ç¼“å­˜ç›®å½•è·¯å¾„ | ç¼“å­˜ä½ç½®ç®¡ç† |
| `clear_cache` | ğŸ”¥ | æ¸…ç©ºæ‰€æœ‰ç¼“å­˜ | å®šæœŸæ¸…ç† |
| `clear_expired_cache` | ğŸ”¥ | æ¸…ç†è¿‡æœŸç¼“å­˜ | è‡ªåŠ¨ç»´æŠ¤ |
| `get_dir_size` | ğŸ’¡ | è·å–ç›®å½•å¤§å° | ç¼“å­˜ç›‘æ§ |
| `empty_cache_path` | ğŸ’¡ | æ¸…ç©ºç¼“å­˜ç›®å½• | ä¸€é”®æ¸…ç† |

### API å‚è€ƒ

```python
# ä½¿ç”¨è£…é¥°å™¨ç¼“å­˜å‡½æ•°ç»“æœ
@disk_cache(cache_key="my_func_{arg1}_{arg2}")
def my_expensive_function(arg1, arg2):
    # è€—æ—¶è®¡ç®—
    return result

# ç¼“å­˜ç®¡ç†ç±»
cache = DiskCache()
cache.set("key", value, expire=3600)
result = cache.get("key")

# æ¸…ç†ç¼“å­˜
clear_cache()  # æ¸…ç©ºæ‰€æœ‰
clear_expired_cache()  # æ¸…ç†è¿‡æœŸ
```

### å¿«é€Ÿç¤ºä¾‹

```python
from czsc.utils import disk_cache

@disk_cache(cache_key="calc_{symbol}_{days}", expire=86400)
def calculate_indicators(symbol, days):
    # è€—æ—¶è®¡ç®—
    return result

# ç¬¬ä¸€æ¬¡è°ƒç”¨ä¼šè®¡ç®—å¹¶ç¼“å­˜
result1 = calculate_indicators("000001", 30)
# ç¬¬äºŒæ¬¡è°ƒç”¨ç›´æ¥ä»ç¼“å­˜è¯»å–
result2 = calculate_indicators("000001", 30)
```

---

## 5. å¯è§†åŒ–å·¥å…· (czsc/utils/plotly_plot.py)

### æ¨¡å—æ¦‚è¿°

æä¾›ä¸°å¯Œçš„äº¤äº’å¼å¯è§†åŒ–å·¥å…·ï¼Œæ”¯æŒKçº¿å›¾ã€ç¼ è®ºåˆ†æå›¾ã€å›æµ‹ç»“æœå›¾è¡¨ã€æƒé‡åˆ†æå›¾ç­‰å¤šç§å›¾è¡¨ç±»å‹ã€‚

### å·¥å…·åˆ—è¡¨

| å·¥å…·åç§° | é‡è¦æ€§ | åŠŸèƒ½è¯´æ˜ | ä½¿ç”¨åœºæ™¯ |
|---------|--------|----------|----------|
| `KlineChart` | â­ | Kçº¿å›¾è¡¨ç»˜åˆ¶ç±» | äº¤äº’å¼Kçº¿å›¾ |
| `plot_czsc_chart` | â­ | ç»˜åˆ¶ç¼ è®ºåˆ†æå›¾è¡¨ | åˆ†å‹ã€ç¬”ã€çº¿æ®µå¯è§†åŒ– |
| `plot_weight` | ğŸ”¥ | æƒé‡å¯è§†åŒ– | ç­–ç•¥æƒé‡åˆ†æ |
| `plot_backtest` | ğŸ”¥ | å›æµ‹ç»“æœå¯è§†åŒ– | å›æµ‹æŠ¥å‘Šå›¾è¡¨ |
| `echarts_plot` | ğŸ’¡ | EChartsé™æ€å›¾è¡¨ | ç½‘é¡µå±•ç¤º |

### API å‚è€ƒ

```python
# Kçº¿å›¾è¡¨
kc = KlineChart(n_rows=2)
kc.add_kline(df, name="000001")
kc.show()

# ç¼ è®ºå›¾è¡¨
plot_czsc_chart(czsc_obj, show_bi=True, show_xd=True)

# æƒé‡å¯è§†åŒ–
plot_weight(weights_df, title="ç­–ç•¥æƒé‡åˆ†æ")
```

### å¿«é€Ÿç¤ºä¾‹

```python
from czsc.utils.plotly_plot import KlineChart, plot_czsc_chart

# åˆ›å»ºKçº¿å›¾
kc = KlineChart()
kc.add_kline(df, name="000001")
kc.add_series(df['ma5'], name="MA5", row=1)
kc.show()

# ç»˜åˆ¶ç¼ è®ºåˆ†æå›¾
plot_czsc_chart(czsc_obj, show_bi=True, show_xd=True)
```

---

## 6. å›æµ‹åˆ†æ (czsc/svc/backtest.py)

### æ¨¡å—æ¦‚è¿°

æä¾›å®Œæ•´çš„æƒé‡å›æµ‹æ¡†æ¶ï¼Œæ”¯æŒå¤šå“ç§ã€å¤šç­–ç•¥çš„å›æµ‹åˆ†æï¼ŒåŒ…æ‹¬ç»©æ•ˆè®¡ç®—ã€é£é™©æŒ‡æ ‡ã€æŠ¥å‘Šç”Ÿæˆç­‰åŠŸèƒ½ã€‚

### å·¥å…·åˆ—è¡¨

| å·¥å…·åç§° | é‡è¦æ€§ | åŠŸèƒ½è¯´æ˜ | ä½¿ç”¨åœºæ™¯ |
|---------|--------|----------|----------|
| `WeightBacktest` | â­ | æƒé‡å›æµ‹æ ¸å¿ƒç±» | ç­–ç•¥å›æµ‹ |
| `daily_performance` | â­ | æ—¥ç»©æ•ˆè®¡ç®— | å›æµ‹æŒ‡æ ‡åˆ†æ |
| `top_drawdowns` | â­ | æœ€å¤§å›æ’¤è®¡ç®— | é£é™©è¯„ä¼° |
| `backtest_report` | ğŸ”¥ | å›æµ‹æŠ¥å‘Šç”Ÿæˆ | æŠ¥å‘Šè¾“å‡º |
| `HtmlReportBuilder` | ğŸ”¥ | HTMLæŠ¥å‘Šæ„å»ºå™¨ | ç¾åŒ–æŠ¥å‘Š |

### API å‚è€ƒ

```python
# åˆ›å»ºå›æµ‹å¯¹è±¡
wb = WeightBacktest(weights_df, price_df)

# è®¡ç®—ç»©æ•ˆ
stats = wb.daily_performance()
print(stats['å¹´åŒ–æ”¶ç›Šç‡'])

# æœ€å¤§å›æ’¤
drawdowns = top_drawdowns(stats['å‡€å€¼æ›²çº¿'], top_n=5)

# ç”ŸæˆæŠ¥å‘Š
report = backtest_report(wb)
```

### å¿«é€Ÿç¤ºä¾‹

```python
from czsc.core import WeightBacktest

# å‡†å¤‡æ•°æ®å’Œæƒé‡
wb = WeightBacktest(weights_df, price_df)

# è·å–å›æµ‹ç»“æœ
results = wb.results
print(f"å¹´åŒ–æ”¶ç›Šç‡: {results['å¹´åŒ–æ”¶ç›Šç‡']:.2%}")
print(f"æœ€å¤§å›æ’¤: {results['æœ€å¤§å›æ’¤']:.2%}")
print(f"å¤æ™®æ¯”ç‡: {results['å¤æ™®æ¯”ç‡']:.2f}")
```

---

## 7. ç­–ç•¥ç ”ç©¶ (czsc/sensors/cta.py)

### æ¨¡å—æ¦‚è¿°

æä¾›CTAç­–ç•¥ç ”ç©¶æ¡†æ¶ï¼Œæ”¯æŒå•å“ç§å›æ”¾ã€å¤šå“ç§ä¼˜åŒ–ã€å‚æ•°ç½‘æ ¼æœç´¢ç­‰åŠŸèƒ½ï¼Œæ˜¯ç­–ç•¥å¼€å‘çš„æ ¸å¿ƒå·¥å…·ã€‚

### å·¥å…·åˆ—è¡¨

| å·¥å…·åç§° | é‡è¦æ€§ | åŠŸèƒ½è¯´æ˜ | ä½¿ç”¨åœºæ™¯ |
|---------|--------|----------|----------|
| `CTAResearch` | â­ | CTAç ”ç©¶æ¡†æ¶ | ç­–ç•¥å›æ”¾ä¸ä¼˜åŒ– |
| `EventMatchSensor` | ğŸ”¥ | äº‹ä»¶åŒ¹é…ä¼ æ„Ÿå™¨ | äº‹ä»¶é©±åŠ¨ç­–ç•¥ |
| `holds_concepts_effect` | ğŸ”¥ | æŒä»“æ¦‚å¿µæ•ˆæœåˆ†æ | æ¿å—åˆ†æ |
| `FixedNumberSelector` | ğŸ’¡ | å›ºå®šæ•°é‡é€‰æ‹©å™¨ | å› å­ç­›é€‰ |

### API å‚è€ƒ

```python
# CTAç ”ç©¶
cta = CTAResearch(symbol="000001", sdt="20230101", edt="20231231")
results = cta.run(param_grid)

# äº‹ä»¶åŒ¹é…
sensor = EventMatchSensor(events_config)
matches = sensor.match(czsc_obj)
```

### å¿«é€Ÿç¤ºä¾‹

```python
from czsc.sensors import CTAResearch

# åˆ›å»ºCTAç ”ç©¶å¯¹è±¡
cta = CTAResearch(symbol="000001", sdt="20230101", edt="20231231")

# å‚æ•°ç½‘æ ¼æœç´¢
param_grid = {'param1': [1, 2, 3], 'param2': [0.5, 1.0]}
results = cta.run(param_grid)

# æŸ¥çœ‹æœ€ä¼˜å‚æ•°
best_params = results.nlargest(1, 'å¤æ™®æ¯”ç‡')
```

---

## 8. å®ç”¨å·¥å…·é›† - äº¤æ˜“ä¸ç»©æ•ˆ (czsc/traders/)

### æ¨¡å—æ¦‚è¿°

æä¾›äº¤æ˜“æ‰§è¡Œã€ä¿¡å·ç®¡ç†ã€æŒä»“ç®¡ç†ç­‰æ ¸å¿ƒäº¤æ˜“åŠŸèƒ½çš„å·¥å…·é›†ã€‚

### å·¥å…·åˆ—è¡¨

| å·¥å…·åç§° | é‡è¦æ€§ | åŠŸèƒ½è¯´æ˜ | ä½¿ç”¨åœºæ™¯ |
|---------|--------|----------|----------|
| `CzscTrader` | â­ | äº¤æ˜“æ‰§è¡Œæ ¸å¿ƒç±» | å¤šçº§åˆ«äº¤æ˜“ |
| `CzscSignals` | â­ | ä¿¡å·ç®¡ç†ç±» | ä¿¡å·ç”Ÿæˆä¸åŒ¹é… |
| `generate_czsc_signals` | ğŸ”¥ | ç”ŸæˆCZSCä¿¡å· | æ‰¹é‡ä¿¡å·ç”Ÿæˆ |
| `check_signals_acc` | ğŸ”¥ | æ£€æŸ¥ä¿¡å·å‡†ç¡®æ€§ | ä¿¡å·éªŒè¯ |
| `rolling_daily_performance` | ğŸ”¥ | æ»šåŠ¨æ—¥ç»©æ•ˆ | ç»©æ•ˆè·Ÿè¸ª |
| `holds_performance` | ğŸ”¥ | æŒä»“ç»©æ•ˆè®¡ç®— | ç»„åˆåˆ†æ |
| `stoploss_by_direction` | ğŸ’¡ | æ–¹å‘æ­¢æŸ | é£é™©æ§åˆ¶ |

### API å‚è€ƒ

```python
# åˆ›å»ºäº¤æ˜“å‘˜
trader = CzscTrader(signal_config, pos_config)

# ç”Ÿæˆä¿¡å·
signals = generate_czsc_signals(bars, signals_config)

# æ£€æŸ¥ä¿¡å·å‡†ç¡®æ€§
acc = check_signals_acc(signals_df, events_df)

# æ»šåŠ¨ç»©æ•ˆ
perf = rolling_daily_performance(weights_df, returns_df, window=20)
```

---

## 9. å®ç”¨å·¥å…·é›† - æ•°æ®å¤„ç† (czsc/utils/)

### æ¨¡å—æ¦‚è¿°

æä¾›æ•°æ®è½¬æ¢ã€æ¨ªæˆªé¢åˆ†æã€ç‰¹å¾å·¥ç¨‹ç­‰æ•°æ®å¤„ç†å®ç”¨å·¥å…·ã€‚

### å·¥å…·åˆ—è¡¨

| å·¥å…·åç§° | é‡è¦æ€§ | åŠŸèƒ½è¯´æ˜ | ä½¿ç”¨åœºæ™¯ |
|---------|--------|----------|----------|
| `resample_to_daily` | ğŸ”¥ | é‡é‡‡æ ·ä¸ºæ—¥çº¿ | æ•°æ®è½¬æ¢ |
| `cross_sectional_ranker` | ğŸ”¥ | æ¨ªæˆªé¢æ’å | æˆªé¢ç­–ç•¥ |
| `cross_sectional_ic` | ğŸ”¥ | æ¨ªæˆªé¢ICè®¡ç®— | å› å­æœ‰æ•ˆæ€§ |
| `update_bbars` | ğŸ”¥ | æ›´æ–°åŸºç¡€Kçº¿æ•°æ® | æ•°æ®ç»´æŠ¤ |
| `update_tbars` | ğŸ”¥ | æ›´æ–°åˆæˆKçº¿æ•°æ® | æ•°æ®ç»´æŠ¤ |
| `normalize_feature` | ğŸ’¡ | ç‰¹å¾æ ‡å‡†åŒ– | å› å­é¢„å¤„ç† |
| `feature_cross_layering` | ğŸ’¡ | ç‰¹å¾äº¤å‰åˆ†å±‚ | ç‰¹å¾å·¥ç¨‹ |

### API å‚è€ƒ

```python
# æ¨ªæˆªé¢æ’å
rank_df = cross_sectional_ranker(factor_df)

# æ¨ªæˆªé¢IC
ic = cross_sectional_ic(factor_df, return_df)

# ç‰¹å¾æ ‡å‡†åŒ–
norm_feature = normalize_feature(raw_feature, method='zscore')
```

---

## 10. å®ç”¨å·¥å…·é›† - ç»Ÿè®¡ä¸å› å­ (czsc/eda.py)

### æ¨¡å—æ¦‚è¿°

æä¾›æ¢ç´¢æ€§æ•°æ®åˆ†æã€å› å­æ£€éªŒã€ç»©æ•ˆåˆ†æç­‰ç»Ÿè®¡å·¥å…·ï¼Œæ˜¯é‡åŒ–ç ”ç©¶çš„é‡è¦è¾…åŠ©ã€‚

### å·¥å…·åˆ—è¡¨

| å·¥å…·åç§° | é‡è¦æ€§ | åŠŸèƒ½è¯´æ˜ | ä½¿ç”¨åœºæ™¯ |
|---------|--------|----------|----------|
| `remove_beta_effects` | ğŸ”¥ | å»é™¤betaå½±å“ | å› å­ä¸­æ€§åŒ– |
| `vwap` | ğŸ”¥ | æˆäº¤é‡åŠ æƒå‡ä»· | äº¤æ˜“åˆ†æ |
| `twap` | ğŸ”¥ | æ—¶é—´åŠ æƒå‡ä»· | äº¤æ˜“åˆ†æ |
| `judge_factor_direction` | ğŸ”¥ | å› å­æ–¹å‘åˆ¤æ–­ | å› å­æµ‹è¯• |
| `monotonicity` | ğŸ’¡ | å•è°ƒæ€§åˆ†æ | å› å­æ£€éªŒ |
| `turnover_rate` | ğŸ’¡ | æ¢æ‰‹ç‡è®¡ç®— | æµåŠ¨æ€§åˆ†æ |
| `make_price_features` | ğŸ’¡ | ä»·æ ¼ç‰¹å¾å·¥ç¨‹ | ç‰¹å¾ç”Ÿæˆ |
| `cross_sectional_strategy` | ğŸ’¡ | æ¨ªæˆªé¢ç­–ç•¥ | æˆªé¢ç­–ç•¥ |

### API å‚è€ƒ

```python
# å»é™¤betaå½±å“
neutral_factor = remove_beta_effects(factor_df, returns_df)

# å› å­æ–¹å‘åˆ¤æ–­
direction = judge_factor_direction(factor_df, returns_df)

# å•è°ƒæ€§åˆ†æ
mono_score = monotonicity(factor_df, returns_df)
```

---

## æŒ‰åŠŸèƒ½æŸ¥æ‰¾ç´¢å¼•

### æ•°æ®è·å–ç±»
- è·å–å¸‚åœºæ•°æ® â†’ `DataClient`
- æ•°æ®æ ¼å¼è½¬æ¢ â†’ `format_standard_kline`
- å¤šçº§åˆ«Kçº¿åˆæˆ â†’ `BarGenerator`

### åˆ†æè®¡ç®—ç±»
- ç¼ è®ºåˆ†æ â†’ `CZSC`
- æŠ€æœ¯æŒ‡æ ‡è®¡ç®— â†’ `ta` æ¨¡å—ï¼ˆMACDã€RSIç­‰ï¼‰
- å› å­åˆ†æ â†’ `eda` æ¨¡å—
- æ¨ªæˆªé¢åˆ†æ â†’ `cross_sectional_ranker`

### å¯è§†åŒ–ç±»
- Kçº¿å›¾è¡¨ â†’ `KlineChart`
- ç¼ è®ºå›¾è¡¨ â†’ `plot_czsc_chart`
- å›æµ‹æŠ¥å‘Š â†’ `plot_backtest`
- æƒé‡åˆ†æ â†’ `plot_weight`

### å›æµ‹ç­–ç•¥ç±»
- æƒé‡å›æµ‹ â†’ `WeightBacktest`
- CTAç ”ç©¶ â†’ `CTAResearch`
- ç­–ç•¥æ‰§è¡Œ â†’ `CzscTrader`
- å‚æ•°ä¼˜åŒ– â†’ `OpensOptimize` / `ExitsOptimize`

### å·¥å…·è¾…åŠ©ç±»
- ç¼“å­˜ç®¡ç† â†’ `disk_cache`
- æ•°æ®åŠ å¯† â†’ `fernet_encrypt`
- äº¤æ˜“æ—¥å† â†’ `is_trading_date`
- æŒä»“ç®¡ç† â†’ `Position`

---

## å¿«é€Ÿä¸Šæ‰‹æŒ‡å—

### å…¸å‹å·¥ä½œæµç¨‹

ä¸€ä¸ªå®Œæ•´çš„ CZSC å·¥ä½œæµç¨‹é€šå¸¸åŒ…å«ä»¥ä¸‹æ­¥éª¤ï¼š

```python
# 1. æ•°æ®è·å–
from czsc.utils import DataClient
dc = DataClient(symbol="000001", sdt="20240101", edt="20240105")
df = dc.get_kline()

# 2. æ•°æ®å¤„ç†
from czsc.core import format_standard_kline, CZSC, Freq
bars = format_standard_kline(df, freq=Freq.F30)

# 3. ç¼ è®ºåˆ†æ
czsc_obj = CZSC(bars)

# 4. å¯è§†åŒ–
from czsc.utils.plotly_plot import plot_czsc_chart
plot_czsc_chart(czsc_obj, show_bi=True, show_xd=True)
```

### å·¥å…·ä½¿ç”¨é¡ºåº

**å¿…éœ€é¡ºåº**
```
æ•°æ®è·å– (DataClient) â†’ æ•°æ®è½¬æ¢ (format_standard_kline) â†’ åˆ†æ (CZSC) â†’ å¯è§†åŒ–/å›æµ‹
```

**ç‹¬ç«‹ä½¿ç”¨**
- ç¼“å­˜å·¥å…· (`disk_cache`) å¯åœ¨ä»»ä½•è€—æ—¶å‡½æ•°ä¸Šä½¿ç”¨
- æŠ€æœ¯æŒ‡æ ‡ (`ta` æ¨¡å—) å¯ç‹¬ç«‹è®¡ç®—
- ç»Ÿè®¡å·¥å…· (`eda` æ¨¡å—) å¯å•ç‹¬ä½¿ç”¨

---

## å¸¸è§ä½¿ç”¨åœºæ™¯

### åœºæ™¯1ï¼šå•å“ç§ç­–ç•¥å›æµ‹

**æ¶‰åŠå·¥å…·**ï¼š`DataClient` â†’ `CZSC` â†’ `CzscTrader` â†’ `WeightBacktest`

**é€‚ç”¨åœºæ™¯**ï¼šéªŒè¯å•ä¸ªå“ç§çš„äº¤æ˜“ç­–ç•¥

```python
from czsc.utils import DataClient
from czsc.core import CZSC, format_standard_kline, Freq
from czsc.traders import CzscTrader

# è·å–æ•°æ®å¹¶åˆ†æ
dc = DataClient(symbol="000001", sdt="20230101", edt="20231231")
df = dc.get_kline()
bars = format_standard_kline(df, freq=Freq.F30)
czsc_obj = CZSC(bars)

# åˆ›å»ºäº¤æ˜“å‘˜å¹¶å›æµ‹
trader = CzscTrader(signal_config, pos_config)
results = trader.backtest(czsc_obj)
```

### åœºæ™¯2ï¼šå¤šå“ç§ç»„åˆä¼˜åŒ–

**æ¶‰åŠå·¥å…·**ï¼š`CTAResearch` â†’ `OpensOptimize` / `ExitsOptimize`

**é€‚ç”¨åœºæ™¯**ï¼šå¤šå“ç§å‚æ•°ä¼˜åŒ–

```python
from czsc.sensors import CTAResearch

# åˆ›å»ºç ”ç©¶æ¡†æ¶
cta = CTAResearch(symbols=["000001", "000002"], sdt="20230101", edt="20231231")

# å‚æ•°ä¼˜åŒ–
param_grid = {'open_para': [1, 2, 3], 'exit_para': [0.5, 1.0]}
results = cta.optimize(param_grid)
```

### åœºæ™¯3ï¼šå› å­ç ”ç©¶ä¸åˆ†æ

**æ¶‰åŠå·¥å…·**ï¼š`cross_sectional_ic` â†’ `judge_factor_direction` â†’ `remove_beta_effects`

**é€‚ç”¨åœºæ™¯**ï¼šè¯„ä¼°å› å­çš„æœ‰æ•ˆæ€§

```python
from czsc.utils import cross_sectional_ic
from czsc.eda import judge_factor_direction, remove_beta_effects

# è®¡ç®—IC
ic = cross_sectional_ic(factor_df, return_df)

# åˆ¤æ–­æ–¹å‘
direction = judge_factor_direction(factor_df, return_df)

# å› å­ä¸­æ€§åŒ–
neutral_factor = remove_beta_effects(factor_df, return_df)
```

### åœºæ™¯4ï¼šå®æ—¶ç›‘æ§ä¸å¯è§†åŒ–

**æ¶‰åŠå·¥å…·**ï¼š`DataClient` â†’ `BarGenerator` â†’ `plot_czsc_chart`

**é€‚ç”¨åœºæ™¯**ï¼šå®æ—¶æ•°æ®å¯è§†åŒ–

```python
from czsc.utils import DataClient
from czsc.utils.plotly_plot import plot_czsc_chart

# è·å–å®æ—¶æ•°æ®
dc = DataClient(symbol="000001")
df = dc.get_kline()

# å¯è§†åŒ–
bars = format_standard_kline(df, freq=Freq.F30)
czsc_obj = CZSC(bars)
plot_czsc_chart(czsc_obj, show_bi=True, show_xd=True)
```

---

## å·¥å…·ä½¿ç”¨é¢‘ç‡ç»Ÿè®¡

| ä¼˜å…ˆçº§ | å·¥å…·æ•°é‡ | å»ºè®®å­¦ä¹ é¡ºåº | å…¸å‹å·¥å…· |
|--------|----------|--------------|----------|
| â­ å¿…ç”¨é«˜é¢‘ | ~15ä¸ª | ç¬¬ä¸€å‘¨æŒæ¡ | CZSC, DataClient, format_standard_kline, Freq, BarGenerator, KlineChart, WeightBacktest, daily_performance, top_drawdowns |
| ğŸ”¥ å¸¸ç”¨ä¸­é¢‘ | ~25ä¸ª | ç¬¬äºŒå‘¨æŒæ¡ | Signal, Event, Position, MACD, RSI, BOLL, disk_cache, plot_czsc_chart, CTAResearch, CzscTrader |
| ğŸ’¡ ç‰¹å®šåœºæ™¯ | ~30ä¸ª | æŒ‰éœ€å­¦ä¹  | ZS, fernet_encrypt, echarts_plot, EventMatchSensor, monotonicity |

---

## æ‰©å±•èµ„æº

### å®˜æ–¹æ–‡æ¡£
- å®Œæ•´APIæ–‡æ¡£ï¼šhttps://czsc.readthedocs.io/en/latest/modules.html
- é¡¹ç›®é£ä¹¦æ–‡æ¡£ï¼šhttps://s0cqcxuy3p.feishu.cn/wiki/wikcn3gB1MKl3ClpLnboHM1QgKf

### ç¤ºä¾‹ä»£ç 
- åŸºç¡€ç¤ºä¾‹ï¼š`examples/30åˆ†é’Ÿç¬”éå¤šå³ç©º.py`
- CTAç ”ç©¶ï¼š`examples/use_cta_research.py`
- å‚æ•°ä¼˜åŒ–ï¼š`examples/use_optimize.py`
- Streamlitåº”ç”¨ï¼š`examples/animotion/`

### è§†é¢‘æ•™ç¨‹
- Bç«™æ•™ç¨‹ï¼šhttps://space.bilibili.com/243682308/channel/series

### ä¿¡å·å‡½æ•°å¼€å‘
- ç¼–å†™è§„èŒƒï¼šhttps://s0cqcxuy3p.feishu.cn/wiki/wikcnCFLLTNGbr2THqo7KtWfBkd

---

## ç‰ˆæœ¬è¯´æ˜ä¸å…¼å®¹æ€§

### Rust/Python æ··åˆæ¶æ„
- **ç‰ˆæœ¬æ§åˆ¶**ï¼šé€šè¿‡ç¯å¢ƒå˜é‡ `CZSC_USE_PYTHON` æ§åˆ¶
- **é»˜è®¤è¡Œä¸º**ï¼šä¼˜å…ˆä½¿ç”¨ Rust ç‰ˆæœ¬ï¼ˆrs-czscï¼‰ï¼Œæ€§èƒ½æ›´ä¼˜
- **å›é€€æœºåˆ¶**ï¼šRust ç‰ˆæœ¬ä¸å¯ç”¨æ—¶è‡ªåŠ¨å›é€€åˆ° Python ç‰ˆæœ¬

### ç¯å¢ƒå˜é‡
```bash
# å¼ºåˆ¶ä½¿ç”¨ Python ç‰ˆæœ¬
export CZSC_USE_PYTHON=1

# ç¼ è®ºå‚æ•°
export czsc_min_bi_len=6  # æœ€å°ç¬”é•¿åº¦
export czsc_max_bi_num=50  # æœ€å¤§ç¬”æ•°é‡
```

### ä¾èµ–å…³ç³»
- Python 3.8+
- æ¨èä½¿ç”¨ UV è¿›è¡Œä¾èµ–ç®¡ç†
- å‚è€ƒ `docs/UVç®¡ç†å¼€æºé¡¹ç›®æŒ‡å—.md`

---

*æ–‡æ¡£æœ€åæ›´æ–°ï¼š2025-01-15*
*CZSC ç‰ˆæœ¬ï¼š0.10.8*
