## 0.3.XX 开发文档


### 笔识别过程

对已完成走势划分笔

    划分笔的步骤：
    （1）确定所有符合标准的分型。
        （1.1）用大小为2的窗口在分型序列上滑动，如果窗口内的两个分型
              之间存在4根以上无包含关系的K线，则保留窗口中的两个分型；
        （1.2）取出所有分型中的顶分型序列，用大小为3的窗口在顶分型序列
              上滑动，如果中间的分型值最大，则保留窗口中间的顶分型；
        （1.3）取出所有分型中的底分型序列，同样用大小为3的窗口进行滑动，
              如果中间的分型值最小，则保留窗口中间的底分型；
        
    （2）合并第（1）步保留下来的顶底分型序列，按时间排序，遍历，如果前后两分型是同一性质的，对于顶，前面的低于后面的，只保留后面的，
        前面那个可以忽略掉；对于底，前面的高于后面的，只保留后面的，前面那个可以忽略掉。不满足上面情况的，例如相等的，都可以先保留。
    （3）经过步骤（2）的处理后，余下的分型，如果相邻的是顶和底，那么这就可以划为一笔。


处理最后一个笔标记

    最后一个笔标记后有两种情况：
    1） 出现顶、底分型，使得最后一笔满足定义，加上对应的标记；
    2） 没有出现使得最后一笔满足定义的顶底分型，耐心等待。

    特别的，对应最后一个笔标记：最后一根K线的最高价大于顶，或最后一根K线的最低价大于底，则删除这个标记。

### 线段识别过程

线段划分，按照走势是否完成可以拆分成两个任务：1）对已完成走势进行线段划分；2）对当下走势进行线段划分。
对已完成走势进行线段划分是很容易的，只要按定义来就可以，不存在模糊的概念。
如何对当下走势进行精确的线段划分是需要点功夫的，在实战中积累经验才行。

**目前，`chan` 能够对当下走势按照定义进行划分，但是这种划分结果的精度是不高的，准备使用`chan` 的交易者要理解这个问题。**
使用缠论的交易者能否赚钱，其关键就在于对当下走势的线段划分精度，

对已完成走势进行线段划分

    对已完成走势进行线段划分的步骤：
    （1）确定所有符合标准的笔标记。
        （1.1）取出所有笔标记中的顶分型序列，用大小为3的窗口在顶分型序列上滑动，如果中间的分型值最大，则保留窗口中间的笔标记；
        （1.3）取出所有笔标记中的底分型序列，同样用大小为3的窗口进行滑动，如果中间的分型值最小，则保留窗口中间的的笔标记；
    （2）合并第（1）步保留下来的笔标记序列，按时间排序，遍历，如果前后两分型是同一性质的，对于顶，前面的低于后面的，只保留后面的，
        前面那个可以忽略掉；对于底，前面的高于后面的，只保留后面的，前面那个可以忽略掉。不满足上面情况的，例如相等的，都可以先保留。
    （3）经过步骤（2）的处理后，余下的分型，如果相邻的是顶和底，那么这就可以划为一线段。
    （4）处理当下走势的线段划分，即最后一个线段标记的处理。

处理最后一个线段标记

    最后一个线段后有两种情况：
    1） 出现笔的顶、底背驰，对这种情况，在背驰出现的位置加上对应的线段标记；
    2） 没有出现笔的顶、底背驰，不需要进行处理，耐心等待笔的顶、底背驰出现或者小转大出现。

    特别的，对最后一个线段标记：最后一根K线的最高价大于顶，或最后一根K线的最低价大于底，则删除这个标记。
    

## 买卖点识别逻辑


### 一买识别逻辑

    1）必须：上级别最后一个线段标记和最后一个笔标记重合且为底分型；
    2）必须：上级别最后一个向下线段内部笔标记数量大于等于6，且本级别最后一个线段标记为底分型；
    3）必须：本级别向下线段背驰 或 本级别向下笔背驰；

    4）辅助：下级别向下线段背驰 或 下级别向下笔背驰。
    
    
### 一卖识别逻辑
    
    1）必须：上级别最后一个线段标记和最后一个笔标记重合且为顶分型；
    2）必须：上级别最后一个向上线段内部笔标记数量大于等于6，且本级别最后一个线段标记为顶分型；
    3）必须：本级别向上线段背驰 或 本级别向上笔背驰；

    4）辅助：下级别向上线段背驰 或 下级别向上笔背驰。

### 二买识别逻辑

    1）必须：上级别最后一个线段标记和最后一个笔标记都是底分型；
    2）必须：上级别最后一个向下线段内部笔标记数量大于等于6，且本级别最后一个线段标记为底分型，不创新低；
    3）必须：上级别最后一个线段标记后有且只有三个笔标记，且上级别向下笔不创新低；

    4）辅助：下级别向下线段背驰 或 下级别向下笔背驰


### 二卖识别逻辑
    
    1）必须：上级别最后一个线段标记和最后一个笔标记都是顶分型；
    2）必须：上级别最后一个向上线段内部笔标记数量大于等于6，且本级别最后一个线段标记为顶分型，不创新高；
    3）必须：上级别最后一个线段标记后有且只有三个笔标记，且上级别向上笔不创新低；

    4）辅助：下级别向上线段背驰 或 下级别向上笔背驰


### 三买识别逻辑

    1）必须：本级别有6个以上线段标记，且最后一个线段标记为底分型；
    2）必须：前三段有价格重叠部分，构成中枢；
    2）必须：第4段比第2段新高无背驰，第5段不跌回中枢；

    4）辅助：向上中枢数量小于等于3


### 三卖识别逻辑

    1）必须：本级别有6个以上线段标记，且最后一个线段标记为顶分型；
    2）必须：前三段有价格重叠部分，构成中枢；
    2）必须：第4段比第2段新低无背驰，第5段不升回中枢；

    4）辅助：向下中枢数量小于等于3


### 线买识别逻辑

    1） 必须：本级别至少有 3 个线段标记且最后一个线段标记为底分型；
    2） 必须：本级别向下线段背驰 或 本级别向下线段不创新低；

    3） 辅助：上级别向下笔背驰 或 上级别向下笔不创新低
    4） 辅助：下级别向下笔背驰
    
### 线卖识别逻辑
    
    1） 必须：本级别至少有 3 个线段标记且最后一个线段标记为顶分型；
    2） 必须：本级别向上线段背驰 或 本级别向上线段不创新高；

    3） 辅助：上级别向上笔背驰 或 上级别向上笔不创新高
    4） 辅助：下级别向上笔背驰

